//  names start with cap are states
//  names start with app:: are appliction handlers
//  names start with dum:: are dum interface to application
//  names start with lower case are actions
//  names start with on are events

digraph UAC {
        rankdir=LR;
        node [shape = box];

        Connected -> SentUpdate [ label = "dum::provideOffer/send::UPDATE" ];
        SentUpdate -> Connected [ label = "on200U/app::onAnswer" ];
        SentUpdate -> Connected [ label = "on4XXU/app::onOfferRejected" ];
        SentUpdate -> Terminated [ label = "onGeneralFailure/app::onTerminated" ];
        SentUpdate -> Terminated [ label = "dum::end/app::onTerminated" ];

        Connected -> SentReinvite [ label = "dum::provideOffer/send::INVITE" ]; // UPDATE not supported
        SentReinvite -> Connected [ label = "on200I/app::onAnswer,send::ACK" ];
        SentReinvite -> Connected [ label = "on4XXI/app::onOfferRejected" ];
        SentReinvite -> Terminated [ label = "onGeneralFailure/app::onTerminated" ];
        SentReinvite -> WaitingToTerminate [ label = "dum::end" ];

        Connected -> ReceivedUpdate [ label = "onUPDATE/app::onOffer" ];
        ReceivedUpdate -> Connected [ label = "dum::provideAnswer/send::200U" ];
        ReceivedUpdate -> Connected [ label = "dum::reject/send::488U" ];
        ReceivedUpdate -> Terminated [ label = "dum::end/send::488U,send::BYE" ];

        Connected -> ReceivedReinvite [ label = "onINVITE/app::onOffer" ];
        ReceivedReinvite -> Connected [ label = "dum::provideAnswer/send::200I" ];
        ReceivedReinvite -> Connected [ label = "dum::reject/send::488U" ];
        ReceivedReinvite -> Terminated [ label = "dum::end/send::488I,send::BYE" ];

        Connected -> ReceivedReinviteNoOffer [ label = "onINVITE/app::onDialogModified" ];
        ReceivedReinviteNoOffer -> Connected [ label = "dum::provideOffer/send::200-offer" ];
        ReceivedReinviteNoOffer -> Connected [ label = "dum::reject/send::488I" ];
        ReceivedReinviteNoOffer -> Terminated [ label = "dum::end/send::488I,send::BYE" ];

        Connected -> Connected [ label = "onCANCEL/send::200C" ]; // is this right?

        Connected -> Terminated [ label = "dum::end/send::BYE" ];
        Connected -> Terminated [ label = "onBYE/send::200B" ];

        WaitingToTerminate -> Terminated [ label = "on200I/send::ACK,send::BYE" ];
        WaitingToTerminate -> Terminated [ label = "onFailureI/send::BYE" ];

        Terminated -> Terminated [ label = "on200I/send::ACK" ];
}
