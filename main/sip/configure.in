dnl Process this file with autoconf to produce a configure script.

AC_PREREQ(2.57)

AC_INIT([resiprocate], [0.3], [resiprocate-devel@lists.sourceforge.net])
AM_INIT_AUTOMAKE([1.7.5 nostdinc foreign])

AC_REVISION($Id: configure.in,v 1.2 2003/08/08 05:53:26 wensong Exp $)

AM_MAINTAINER_MODE

AC_LANG(C++)

AC_CONFIG_SRCDIR([resiprocate/config.hxx.in])
AC_CONFIG_HEADER([resiprocate/config.hxx])  

AC_PROG_CXX
AC_PROG_INSTALL
AC_PROG_MAKE_SET
AC_PROG_LIBTOOL

AC_CHECK_HEADERS([sys/sockio.h sys/int_types.h])

# allow alternate toolchains

AC_ARG_WITH(toolchain, [
Build options:
  --with-toolchain=gnu		  use alternate toolchain to compile.],
	[VOCAL_USE_TOOLCHAIN=$with_toolchain],
	[VOCAL_USE_TOOLCHAIN=default])
AC_SUBST(VOCAL_USE_TOOLCHAIN)dnl

# allow alternate toolchain root

AC_ARG_WITH(template-repository, [
  --with-template-repository	  use a template repository with gcc.],
	[VOCAL_USE_GCC_REPO=true],
	[VOCAL_USE_GCC_REPO=false])
AC_SUBST(VOCAL_USE_GCC_REPO)dnl


AC_ARG_WITH(builddir, [
Toolchain options:
  --with-builddir=/path/to/builddir      build in a local directory],
	[echo USE_BUILDDIR=$with_builddir > .make_prefs])

AC_ARG_WITH(crossroot, [
  --with-crossroot=/path/to/bin   root directory for alternate toolchain
                                  (only active for toolchain=armcross)],
	[VOCAL_CROSS_ROOT=$with_crossroot],
	[VOCAL_CROSS_ROOT=default])
AC_SUBST(VOCAL_CROSS_ROOT)dnl


AC_ARG_WITH(ar, [
  --with-ar=/usr/local/bin/ar     path to GNU ar],
	[VOCAL_AR_PATH=$with_ar])

AC_SUBST(VOCAL_AR_PATH)dnl

AC_ARG_WITH(shared-libs, [
  --with-shared-libs              don't build with shared libraries],
	[VOCAL_BUILD_SHARED_LIBS=$with_shared_libs],
	[VOCAL_BUILD_SHARED_LIBS=no])
AC_SUBST(VOCAL_BUILD_SHARED_LIBS)dnl

AC_ARG_WITH(openssl, [
  --with-openssl                  include TLS support via OpenSSL],
	[VOCAL_USE_OPENSSL=true],
	[VOCAL_USE_OPENSSL=false])
AC_SUBST(VOCAL_USE_OPENSSL)dnl

AC_ARG_WITH(distcc, [
  --with-distcc                  use distributed compilation tool distcc],
	[USE_DISTCC=true],
	[USE_DISTCC=false])
AC_SUBST(USE_DISTCC)dnl

RESIP_LIB_OPENSSL
RESIP_LIB_ARES
RESIP_PROG_DISTCC

dnl Temporary hack until proper, portable pthreads detection is added.
LIBS="$LIBS -lpthread"

AC_CONFIG_FILES([Makefile resiprocate/Makefile resiprocate/test/Makefile])
AC_OUTPUT

